<script type="text/javascript">
var secParam=new Array(
4294967295,
0,0 );
</script>
<META http-equiv="Pragma" content="no-cache">
<META http-equiv="Expires" content="wed, 26 Feb 1997 08:21:57 GMT">
<link href="../dynaform/css_main.css" rel="stylesheet" />
<script src="../dynaform/common.js" type="text/javascript"></script>
<script type="text/javascript"><!--
if(window.parent == window){window.location.href="http://192.168.1.1";}
function Click(){return false;}
document.oncontextmenu=Click;
function doPrev(){history.go(-1);}
//--></script>
<html><head><script language="javascript" type="text/javascript">
</script>
<meta http-equiv="Content-Type" content="text/html; charset=GB2312">

<title>TL-WR841N</title>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="wed, 26 Feb 1997 08:21:57 GMT">
<link href="../dynaform/css_main.css" rel="stylesheet" type="text/css">
<script language="javascript" src="../dynaform/common.js" type="text/javascript"></script>
<script language="javascript" type="text/javascript"></script>

	<meta http-equiv="Content-Type" content="text/html; charset=GB2312">
	<script language="JavaScript">
	<!-- 
		function isStatOn(item)
		{
			return 	(secParam[0] & item);
		}
			
		var FW_SPI					=	0x00000001;
		var VPN_PPTP_PASSTHROUGH	=	0x00000100;
		var VPN_L2TP_PASSTHROUGH	=	0x00000200;
		var VPN_IPSEC_PASSTHROUGH	=	0x00000400;
		var NAT_FTP_ALG				=	0x00010000;
		var NAT_TFTP_ALG			=	0x00020000;
		var NAT_H323_ALG			=	0x00040000;
		var NAT_RTSP_ALG			=	0x00080000;
		var spifw = isStatOn(FW_SPI); 
		var pptp = isStatOn(VPN_PPTP_PASSTHROUGH);
		var l2tp = isStatOn(VPN_L2TP_PASSTHROUGH);
		var ipsec = isStatOn(VPN_IPSEC_PASSTHROUGH);
		var ftp = isStatOn(NAT_FTP_ALG);
		var tftp = isStatOn(NAT_TFTP_ALG);
		var h323 = isStatOn(NAT_H323_ALG);
		var rtsp = isStatOn(NAT_RTSP_ALG);
		
		function doSave()
		{			
			var lp = location.pathname;
			
			var s = document.getElementById("enable_spi").checked;
			var p = document.getElementById("enable_pptp_passthrough").checked;
			var l = document.getElementById("enable_l2tp_passthrough").checked;
			var i = document.getElementById("enable_ipsec_passthrough").checked;
			var f = document.getElementById("enable_ftp_alg").checked;
			var t = document.getElementById("enable_tftp_alg").checked;
			var h = document.getElementById("enable_h323_alg").checked;
			var r = document.getElementById("enable_rtsp_alg").checked;
			
			var new_stat = s | (p << 8) | (l << 9) | (i << 10) | (f << 16) | (t << 17) | (h << 18) | (r << 19);
		
			location.href = lp + "?stat=" + new_stat + "&Save=Save";		
			return true;
		}
		
		function doHelp()
		{
			location.href="/help/BasicSecurityHelpRpm.htm";
		}
		
		function doRadioCheck(idF, idS, value)
		{
			var radioF = document.getElementById(idF);
			var radioS = document.getElementById(idS);
			var valueF = radioF.checked;
			var valueS = radioS.checked;
			
			if (value && (valueF == true) && (valueS == true))
			{
				radioF.checked = false;
			}
			else if (!value && (valueF == true) && (valueS == true))
			{
				radioS.checked = false;
			}
		}
		
		function doRadiosChecked()
		{
			doRadioCheck("enable_spi", "disable_spi", spifw);
			doRadioCheck("enable_pptp_passthrough", "disable_pptp_passthrough", pptp);
			doRadioCheck("enable_l2tp_passthrough", "disable_l2tp_passthrough", l2tp);
			doRadioCheck("enable_ipsec_passthrough", "disable_ipsec_passthrough", ipsec);
			doRadioCheck("enable_ftp_alg", "disable_ftp_alg", ftp);
			doRadioCheck("enable_tftp_alg", "disable_tftp_alg", tftp);
			doRadioCheck("enable_h323_alg", "disable_h323_alg", h323);
			doRadioCheck("enable_rtsp_alg", "disable_rtsp_alg", rtsp);
		}
	//-->
	</script>
<meta http-equiv="pragma" content="no-cache"></head><body onload="doRadiosChecked()">
<center>
<center>
<table width="402" border="0" cellpadding="0" cellspacing="0">
<tbody><tr>
	<td class="title" width="7"><img src="../userRpm/images/arc.gif" width="7" height="24"></td>

	<td class="title" width="395" align="left" valign="middle">安全设置</td>
</tr>
<tr><td colspan="2">
	<table width="402" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td class="vline" rowspan="15"><br></td>
			<td width="400">
				<table class="space" width="310" align="center" border="0" cellpadding="0" cellspacing="0">
					<tbody><tr><td>本页对各个基本安全功能的开启与关闭进行设置。</td></tr>

				</tbody></table> 
				
				<table class="space" width="340" align="center" border="1" cellpadding="0" cellspacing="0">
					<tbody><tr><td width="310">
						<table width="300" align="center" border="0" cellpadding="2" cellspacing="0">
							<tbody><tr><td colspan="2" width="300">状态检测防火墙 (SPI)</td></tr>
							<!--<tr><td colspan="2">&nbsp;</td></tr>-->
	<tr>
								<td width="100">&nbsp;&nbsp;SPI 防火墙：</td>
								<td>
									<input name="spi" id="enable_spi" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="spi" id="disable_spi" value="0" type="radio">不启用
								</td>
	</tr>
						</tbody></table>
					</td></tr>
				</tbody></table>
				
				<table class="space" width="340" align="center" border="1" cellpadding="0" cellspacing="0">
					<tbody><tr><td width="310">
						<table width="300" align="center" border="0" cellpadding="2" cellspacing="0">
							<tbody><tr><td colspan="2" width="300">虚拟专用网络 (VPN)</td></tr>
							<!--<tr><td colspan="2">&nbsp;</td></tr>-->
			<tr>
								<td width="100">&nbsp;&nbsp;PPTP 穿透：</td>
								<td>
									<input name="pptp_passthrough" id="enable_pptp_passthrough" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="pptp_passthrough" id="disable_pptp_passthrough" value="0" type="radio">不启用
				</td>
			</tr>		
			<tr>
								<td width="100">&nbsp;&nbsp;L2TP 穿透：</td>
								<td>
									<input name="l2tp_passthrough" id="enable_l2tp_passthrough" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="l2tp_passthrough" id="disable_l2tp_passthrough" value="0" type="radio">不启用
				</td>	
			</tr>		
							<tr>
								<td width="100">&nbsp;&nbsp;IPSec 穿透：</td>
								<td>
									<input name="ipsec_passthrough" id="enable_ipsec_passthrough" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="ipsec_passthrough" id="disable_ipsec_passthrough" value="0" type="radio">不启用
	</td>	
							</tr>					
						</tbody></table>
					</td></tr>
				</tbody></table>
	
				<table class="space" width="340" align="center" border="1" cellpadding="0" cellspacing="0">
					<tbody><tr><td width="310">
						<table width="300" align="center" border="0" cellpadding="2" cellspacing="0">
							<tbody><tr><td colspan="2" width="300">应用层网关 (ALG)</td></tr>
							<!--<tr><td colspan="2">&nbsp;</td></tr>-->
							<tr>
								<td width="100">&nbsp;&nbsp;FTP ALG：</td>
								<td>
									<input name="ftp_alg" id="enable_ftp_alg" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="ftp_alg" id="disable_ftp_alg" value="0" type="radio">不启用
								</td>
							</tr>
	<tr>
								<td width="100">&nbsp;&nbsp;TFTP ALG：</td>
								<td>
									<input name="tftp_alg" id="enable_tftp_alg" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="tftp_alg" id="disable_tftp_alg" value="0" type="radio">不启用
								</td>
							</tr>
							<tr>
								<td width="100">&nbsp;&nbsp;H323 ALG：</td>
								<td>
									<input name="h323_alg" id="enable_h323_alg" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="h323_alg" id="disable_h323_alg" value="0" type="radio">不启用
		</td>
	</tr>	
							<tr>
								<td width="100">&nbsp;&nbsp;RTSP ALG：</td>
								<td>
									<input name="rtsp_alg" id="enable_rtsp_alg" value="1" type="radio">启用&nbsp;&nbsp;
									<input name="rtsp_alg" id="disable_rtsp_alg" value="0" type="radio">不启用
							</td>
							</tr>	
						</tbody></table>
					</td></tr>
				</tbody></table>


			</td>
			<td class="vline" rowspan="15"><br></td>
		</tr>
		<tr><td class="hline"><img src="../userRpm/images/empty.gif" width="1" height="1"></td></tr>
		<tr><td class="tail" height="30"> &nbsp; 			
			<input name="Save" class="button" id="Save" value="保 存" onclick="return doSave();" type="button">&nbsp;
			<input name="Help" class="button" value="帮 助" onclick="doHelp();" type="button">
	</td></tr>
		<tr><td class="hline"><img src="../userRpm/images/empty.gif" width="1" height="1"></td></tr>

	</tbody></table>
</td></tr>

</tbody></table>


	
<script language="JavaScript">
	document.getElementById("enable_spi").checked = spifw;
	document.getElementById("disable_spi").checked = !spifw;
	document.getElementById("enable_pptp_passthrough").checked = pptp;
	document.getElementById("disable_pptp_passthrough").checked = !pptp;
	document.getElementById("enable_l2tp_passthrough").checked = l2tp;
	document.getElementById("disable_l2tp_passthrough").checked = !l2tp;
	document.getElementById("enable_ipsec_passthrough").checked = ipsec;	
	document.getElementById("disable_ipsec_passthrough").checked = !ipsec;
	document.getElementById("enable_ftp_alg").checked = ftp;
	document.getElementById("disable_ftp_alg").checked = !ftp;
	document.getElementById("enable_tftp_alg").checked = tftp;
	document.getElementById("disable_tftp_alg").checked = !tftp;
	document.getElementById("enable_h323_alg").checked = h323;
	document.getElementById("disable_h323_alg").checked = !h323;
	document.getElementById("enable_rtsp_alg").checked = rtsp;
	document.getElementById("disable_rtsp_alg").checked = !rtsp;
</script>


</center></center></body></html>